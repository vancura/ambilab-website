---
import NewsList from '@components/astro/NewsList.astro';
import Button from '@components/svelte/Button.svelte';
import { getRoute } from '@config/routes';
import { getTranslation } from '@i18n/translations';
import type { Locale } from '@type/locale';
import { loadLocaleContent, sortNewsPostsByDate } from '@utils/content-loader';

export interface Props {
    locale: Locale;
    limit?: number;
    showViewAll?: boolean;
}

const { locale, limit = 3, showViewAll = true } = Astro.props as Props;

const t = getTranslation(locale);
const content = await loadLocaleContent(locale);
const sortedPosts = sortNewsPostsByDate(content.newsPosts);
const newsUrl = getRoute('news', locale);
---

<section>
    <NewsList posts={sortedPosts} locale={locale} limit={limit} />

    <div class="mt-8">
        {
            showViewAll && sortedPosts.length > 0 && (
                <Button href={newsUrl} variant="secondary">
                    {t.news.allPosts} â†’
                </Button>
            )
        }
    </div>
</section>
