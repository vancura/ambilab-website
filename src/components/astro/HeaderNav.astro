---
import { getRoute, isRouteActive } from '@config/routes';
/**
 * HeaderNav Component
 *
 * Renders the main navigation menu with active state highlighting.
 *
 * Supports locale-aware routes and determines the active
 * state based on the current path.
 *
 * Features:
 * - Active state highlighting for the current page
 * - Locale-aware route generation
 * - Exact matching for home and about pages
 * - Prefix matching for blog (supports nested routes)
 * - Responsive layout
 *
 * Navigation Matching Strategy:
 * - Locale is domain-based (ambilab.com vs. ambilab.cz),
     so the currentPath never contains /en/ or /cs/ prefixes
 * - Astro does not add trailing slashes by default to canonical URLs
 * - Blog uses startsWith() to match nested routes (e.g., /blog/post-slug)
 * - Home and About use exact equality (===) as they have no nested routes
 *
 * @component
 * @example
 * ```astro
 * <HeaderNav locale="en" currentPath="/blog" />
 * ```
 */
import { getTranslation } from '@i18n/translations';
import type { Locale } from '@type/locale';

/**
 * Props for the HeaderNav component.
 */
export interface Props {
    /** The locale for the navigation labels and route determination. */
    locale: Locale;

    /** The current page path used to determine which navigation item is active. */
    currentPath: string;
}

const { locale, currentPath } = Astro.props as Props;
const t = getTranslation(locale);

/**
 * Navigation items with active state matching.
 *
 * Note on matching strategies:
 * - Locale is domain-based (ambilab.com vs. ambilab.cz),
 *   so the currentPath never contains /en/ or /cs/ prefixes
 * - Astro does not add trailing slashes by default to canonical URLs
 * - Blog uses startsWith() to match nested routes (e.g., /blog/post-slug)
 * - Home and About use exact equality (===) as they have no nested routes
 */
const navItems = [
    {
        href: getRoute('home', locale),
        label: t.nav.home,
        isActive: isRouteActive(currentPath, 'home'),
    },
    {
        href: getRoute('about', locale),
        label: t.nav.about,
        isActive: isRouteActive(currentPath, 'about'),
    },
    {
        href: getRoute('blog', locale),
        label: t.nav.blog,
        isActive: isRouteActive(currentPath, 'blog'),
    },
];
---

<div class="flex items-center gap-6">
    {
        navItems.map((item) => (
            <a
                href={item.href}
                aria-current={item.isActive ? 'page' : undefined}
                class:list={[
                    'focus-visible:ring-link/40 transition-colors hover:text-link-hover focus-visible:outline-none focus-visible:ring-2 dark:hover:text-link-hover-dark',
                    item.isActive &&
                        'underline-offset-10 font-semibold text-link-active underline decoration-2 dark:text-link-active-dark',
                ]}
            >
                {item.label}
            </a>
        ))
    }
</div>
